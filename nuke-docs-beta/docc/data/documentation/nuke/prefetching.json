{"seeAlsoSections":[{"title":"Advanced","identifiers":["doc:\/\/com.github.kean.Nuke\/documentation\/Nuke\/configuration","doc:\/\/com.github.kean.Nuke\/documentation\/Nuke\/caching","doc:\/\/com.github.kean.Nuke\/documentation\/Nuke\/combine","doc:\/\/com.github.kean.Nuke\/documentation\/Nuke\/plugins"],"generated":true}],"schemaVersion":{"major":0,"minor":1,"patch":0},"sections":[],"primaryContentSections":[{"kind":"content","content":[{"anchor":"UICollectionView","level":2,"type":"heading","text":"UICollectionView"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Starting with iOS 10, it became easy to implement prefetching in a "},{"type":"codeVoice","code":"UICollectionView"},{"type":"text","text":" thanks to the "},{"type":"reference","isActive":true,"identifier":"https:\/\/developer.apple.com\/documentation\/uikit\/uicollectionviewdatasourceprefetching"},{"type":"text","text":" API. All you need to do is set "},{"type":"reference","isActive":true,"identifier":"https:\/\/developer.apple.com\/documentation\/uikit\/uicollectionview\/1771771-isprefetchingenabled"},{"type":"text","text":" to "},{"type":"codeVoice","code":"true"},{"type":"text","text":" and set a "},{"type":"reference","isActive":true,"identifier":"https:\/\/developer.apple.com\/documentation\/uikit\/uicollectionview\/1771768-prefetchdatasource"},{"type":"text","text":"."}]},{"type":"codeListing","syntax":"swift","code":["final class PrefetchingDemoViewController: BaseDemoViewController {","    let prefetcher = ImagePrefetcher()","","    override func viewDidLoad() {","        super.viewDidLoad()","","        collectionView?.isPrefetchingEnabled = true","        collectionView?.prefetchDataSource = self","    }","}","","extension PrefetchingDemoViewController: UICollectionViewDataSourcePrefetching {","    func collectionView(_ collectionView: UICollectionView,","                        prefetchItemsAt indexPaths: [IndexPath]) {","        let urls = indexPaths.map { photos[$0.row] }","        prefetcher.startPrefetching(with: urls)","    }","","    func collectionView(_ collectionView: UICollectionView,","                        cancelPrefetchingForItemsAt indexPaths: [IndexPath]) {","        let urls = indexPaths.map { photos[$0.row] }","        prefetcher.startPrefetching(with: urls)","    }","}"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"This code sample comes straight from "},{"type":"reference","isActive":true,"identifier":"https:\/\/github.com\/kean\/NukeDemo"},{"type":"text","text":". So does the following screenshot."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"There are 32 items on the screen (the last row is partially visible). When you open it for the first time, the prefetch API asks the app to start prefetching for indices "},{"type":"codeVoice","code":"[32-55]"},{"type":"text","text":". As you scroll, the prefetch “window” changes. You receive "},{"type":"codeVoice","code":"cancelPrefetchingForItemsAt"},{"type":"text","text":" calls for items no longer in the prefetch window."}]},{"type":"aside","style":"note","content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"UICollectionView"},{"type":"text","text":" offers no customization options. If you want to have more control, check out "},{"type":"reference","isActive":true,"identifier":"https:\/\/github.com\/kean\/Preheat"},{"type":"text","text":". I deprecated it, but you can find it helpful nevertheless."}]}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"When the user goes to another screen, you can either cancel all the prefetching tasks (but then you’ll need to figure out a way to restart them when the user comes back) or, with "},{"type":"reference","isActive":true,"identifier":"https:\/\/github.com\/kean\/Nuke\/releases\/tag\/9.4.0"},{"type":"text","text":", you can simply pause them."}]},{"type":"codeListing","syntax":"swift","code":["override func viewWillAppear(_ animated: Bool) {","    super.viewWillAppear(animated)","","    prefetcher.isPaused = false","}","","override func viewWillDisappear(_ animated: Bool) {","    super.viewWillDisappear(animated)","","    \/\/ When you pause, the prefetcher will finish outstanding tasks","    \/\/ (by default, there are only 2 at a time), and pause the rest.","    prefetcher.isPaused = true","}```","","> Starting with [Nuke 9.5.0](https:\/\/github.com\/kean\/Nuke\/releases\/tag\/9.5.0), you can also change the prefetcher priority. For example, when the user goes to another screen that also has image prefetching, you can lower it to `.veryLow`. This way, the prefetching will continue for both screens, but the top screen will have priority.","","## ImagePrefetcher"," ","You typically create one ``ImagePrefetcher`` per screen.","","```swift","let prefetcher = ImagePrefetcher()","","public final class ImagePrefetcher {","    public init(pipeline: ImagePipeline = ImagePipeline.shared,","                destination: Destination = .memoryCache,","                maxConcurrentRequestCount: Int = 2)","}"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"To start prefetching, call "},{"type":"reference","isActive":true,"identifier":"doc:\/\/com.github.kean.Nuke\/documentation\/Nuke\/ImagePrefetcher\/startPrefetching(with:)"},{"type":"text","text":" method. When you need the same image later to display it, simply use the "},{"type":"reference","isActive":true,"identifier":"doc:\/\/com.github.kean.Nuke\/documentation\/Nuke\/ImagePipeline"},{"type":"text","text":" or view extensions to load the image. The pipeline will take care of coalescing the requests for new without starting any new downloads."}]},{"type":"codeListing","syntax":"swift","code":["public extension ImagePrefetcher {","    func startPrefetching(with urls: [URL])","    func startPrefetching(with requests: [ImageRequest])","","    func stopPrefetching(with urls: [URL])","    func stopPrefetching(with requests: [ImageRequest])","    func stopPrefetching()","}"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"The prefetcher automatically cancels all of the outstanding tasks when deallocated. All "},{"type":"reference","isActive":true,"identifier":"doc:\/\/com.github.kean.Nuke\/documentation\/Nuke\/ImagePrefetcher"},{"type":"text","text":" methods are thread-safe and are optimized to be used even from the main thread during scrolling."}]},{"type":"aside","style":"important","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Keep in mind that prefetching takes up users’ data and puts extra pressure on CPU and memory! To reduce the CPU and memory usage, you have an option to choose only the disk cache as a prefetching destination: "},{"type":"codeVoice","code":"ImagePrefetcher(destination: .diskCache)"},{"type":"text","text":". It doesn’t require image decoding and processing and therefore uses less CPU. The images are stored on disk, so they also take up less memory. This policy doesn’t work with "},{"type":"reference","isActive":true,"identifier":"doc:\/\/com.github.kean.Nuke\/documentation\/Nuke\/ImagePipeline\/Configuration-swift.struct\/DataCachePolicy-swift.enum\/storeEncodedImages"},{"type":"text","text":" cache policy and other policies that affect "},{"type":"codeVoice","code":"loadData()"},{"type":"text","text":"."}]}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"With "},{"overridingTitleInlineContent":[{"type":"text","text":"Nuke 9.4.0"}],"isActive":true,"type":"reference","identifier":"https:\/\/github.com\/kean\/Nuke\/releases\/tag\/9.4.0","overridingTitle":"Nuke 9.4.0"},{"type":"text","text":", you can now also pause prefetching ("},{"type":"reference","isActive":true,"identifier":"doc:\/\/com.github.kean.Nuke\/documentation\/Nuke\/ImagePrefetcher\/isPaused"},{"type":"text","text":"), which is useful when the user navigates to a different screen. And starting with "},{"type":"reference","isActive":true,"identifier":"https:\/\/github.com\/kean\/Nuke\/releases\/tag\/9.5.0"},{"type":"text","text":", you can also change the prefetcher priority. For example, when the user goes to another screen, you can lower it to "},{"type":"codeVoice","code":".veryLow"},{"type":"text","text":"."}]},{"type":"codeListing","syntax":"swift","code":["public extension ImagePrefetcher {","    var isPaused: Bool = false","    var priority: ImageRequest.Priority = .low","}"]}]}],"variants":[{"paths":["\/documentation\/nuke\/prefetching"],"traits":[{"interfaceLanguage":"swift"}]}],"identifier":{"url":"doc:\/\/com.github.kean.Nuke\/documentation\/Nuke\/prefetching","interfaceLanguage":"swift"},"abstract":[{"type":"text","text":"Loading data ahead of time in anticipation of its use (prefetching) is a great way to improve user experience. It’s especially effective for images; it can give users an impression that there is no networking and the images are just magically always there."}],"kind":"article","metadata":{"roleHeading":"Article","title":"Prefetching","role":"article","modules":[{"name":"Nuke"}]},"hierarchy":{"paths":[["doc:\/\/com.github.kean.Nuke\/documentation\/Nuke"]]},"documentVersion":0,"references":{"https://github.com/kean/Nuke/releases/tag/9.4.0":{"title":"Nuke 9.4.0","titleInlineContent":[{"type":"text","text":"Nuke 9.4.0"}],"type":"link","identifier":"https:\/\/github.com\/kean\/Nuke\/releases\/tag\/9.4.0","url":"https:\/\/github.com\/kean\/Nuke\/releases\/tag\/9.4.0"},"doc://com.github.kean.Nuke/documentation/Nuke/ImagePrefetcher/isPaused":{"role":"symbol","title":"isPaused","fragments":[{"kind":"keyword","text":"var"},{"kind":"text","text":" "},{"kind":"identifier","text":"isPaused"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"Bool","preciseIdentifier":"s:Sb"}],"abstract":[{"type":"text","text":"Pauses the prefetching."}],"identifier":"doc:\/\/com.github.kean.Nuke\/documentation\/Nuke\/ImagePrefetcher\/isPaused","kind":"symbol","type":"topic","url":"\/documentation\/nuke\/imageprefetcher\/ispaused"},"https://developer.apple.com/documentation/uikit/uicollectionview/1771768-prefetchdatasource":{"title":"prefetchDataSource","titleInlineContent":[{"type":"codeVoice","code":"prefetchDataSource"}],"type":"link","identifier":"https:\/\/developer.apple.com\/documentation\/uikit\/uicollectionview\/1771768-prefetchdatasource","url":"https:\/\/developer.apple.com\/documentation\/uikit\/uicollectionview\/1771768-prefetchdatasource"},"doc://com.github.kean.Nuke/documentation/Nuke/ImagePrefetcher/startPrefetching(with:)":{"role":"symbol","title":"startPrefetching(with:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"startPrefetching"},{"kind":"text","text":"("},{"kind":"externalParam","text":"with"},{"kind":"text","text":": ["},{"kind":"typeIdentifier","text":"ImageRequestConvertible","preciseIdentifier":"s:4Nuke23ImageRequestConvertibleP"},{"kind":"text","text":"])"}],"abstract":[{"type":"text","text":"Starts prefetching images for the given requests."}],"identifier":"doc:\/\/com.github.kean.Nuke\/documentation\/Nuke\/ImagePrefetcher\/startPrefetching(with:)","kind":"symbol","type":"topic","url":"\/documentation\/nuke\/imageprefetcher\/startprefetching(with:)"},"https://github.com/kean/Nuke/releases/tag/9.5.0":{"title":"Nuke 9.5.0","titleInlineContent":[{"type":"text","text":"Nuke 9.5.0"}],"type":"link","identifier":"https:\/\/github.com\/kean\/Nuke\/releases\/tag\/9.5.0","url":"https:\/\/github.com\/kean\/Nuke\/releases\/tag\/9.5.0"},"doc://com.github.kean.Nuke/documentation/Nuke/plugins":{"role":"article","title":"Plugins","abstract":[{"type":"text","text":"The image pipeline is easy to customize and extend. Check out the following first-class extensions and packages built by the community."}],"identifier":"doc:\/\/com.github.kean.Nuke\/documentation\/Nuke\/plugins","kind":"article","type":"topic","url":"\/documentation\/nuke\/plugins"},"https://github.com/kean/Preheat":{"title":"Preheat","titleInlineContent":[{"type":"text","text":"Preheat"}],"type":"link","identifier":"https:\/\/github.com\/kean\/Preheat","url":"https:\/\/github.com\/kean\/Preheat"},"https://developer.apple.com/documentation/uikit/uicollectionviewdatasourceprefetching":{"title":"UICollectionViewDataSourcePrefetching","titleInlineContent":[{"type":"codeVoice","code":"UICollectionViewDataSourcePrefetching"}],"type":"link","identifier":"https:\/\/developer.apple.com\/documentation\/uikit\/uicollectionviewdatasourceprefetching","url":"https:\/\/developer.apple.com\/documentation\/uikit\/uicollectionviewdatasourceprefetching"},"https://developer.apple.com/documentation/uikit/uicollectionview/1771771-isprefetchingenabled":{"title":"isPrefetchingEnabled","titleInlineContent":[{"type":"codeVoice","code":"isPrefetchingEnabled"}],"type":"link","identifier":"https:\/\/developer.apple.com\/documentation\/uikit\/uicollectionview\/1771771-isprefetchingenabled","url":"https:\/\/developer.apple.com\/documentation\/uikit\/uicollectionview\/1771771-isprefetchingenabled"},"https://github.com/kean/NukeDemo":{"title":"Nuke Demo","titleInlineContent":[{"type":"text","text":"Nuke Demo"}],"type":"link","identifier":"https:\/\/github.com\/kean\/NukeDemo","url":"https:\/\/github.com\/kean\/NukeDemo"},"doc://com.github.kean.Nuke/documentation/Nuke/ImagePrefetcher":{"role":"symbol","title":"ImagePrefetcher","fragments":[{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"kind":"identifier","text":"ImagePrefetcher"}],"abstract":[{"type":"text","text":"Prefetches and caches images to eliminate delays when requesting the same"},{"type":"text","text":" "},{"type":"text","text":"images later."}],"identifier":"doc:\/\/com.github.kean.Nuke\/documentation\/Nuke\/ImagePrefetcher","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"ImagePrefetcher"}],"url":"\/documentation\/nuke\/imageprefetcher"},"doc://com.github.kean.Nuke/documentation/Nuke/combine":{"role":"article","title":"Combine","abstract":[{"type":"reference","isActive":true,"identifier":"doc:\/\/com.github.kean.Nuke\/documentation\/Nuke\/ImagePublisher"},{"type":"text","text":" starts a new "},{"type":"reference","isActive":true,"identifier":"doc:\/\/com.github.kean.Nuke\/documentation\/Nuke\/ImageTask"},{"type":"text","text":" when a subscriber is added and delivers the results to the subscriber. If the requested image is available in the memory cache, the value is delivered immediately. When the subscription is canceled, the task also gets canceled."}],"identifier":"doc:\/\/com.github.kean.Nuke\/documentation\/Nuke\/combine","kind":"article","type":"topic","url":"\/documentation\/nuke\/combine"},"doc://com.github.kean.Nuke/documentation/Nuke/caching":{"role":"article","title":"Caching","abstract":[{"type":"text","text":"Nuke has three cache layers that you can configure to precisely match your app needs. The pipeline uses these caches when you request an image. Your app has advanced control over how images are stored and retrieved and direct access to all cache layers."}],"identifier":"doc:\/\/com.github.kean.Nuke\/documentation\/Nuke\/caching","kind":"article","type":"topic","url":"\/documentation\/nuke\/caching"},"doc://com.github.kean.Nuke/documentation/Nuke/ImagePipeline":{"role":"symbol","title":"ImagePipeline","fragments":[{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"kind":"identifier","text":"ImagePipeline"}],"abstract":[{"type":"codeVoice","code":"ImagePipeline"},{"type":"text","text":" is the primary way to load images directly (without a UI)."}],"identifier":"doc:\/\/com.github.kean.Nuke\/documentation\/Nuke\/ImagePipeline","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"ImagePipeline"}],"url":"\/documentation\/nuke\/imagepipeline"},"doc://com.github.kean.Nuke/documentation/Nuke/configuration":{"role":"article","title":"Configuration","abstract":[{"type":"text","text":"Nuke virtually unlimited possibilities for customization and most of them are done using "},{"type":"reference","isActive":true,"identifier":"doc:\/\/com.github.kean.Nuke\/documentation\/Nuke\/ImagePipeline\/Configuration-swift.struct"},{"type":"text","text":"."}],"identifier":"doc:\/\/com.github.kean.Nuke\/documentation\/Nuke\/configuration","kind":"article","type":"topic","url":"\/documentation\/nuke\/configuration"},"doc://com.github.kean.Nuke/documentation/Nuke/ImagePipeline/Configuration-swift.struct/DataCachePolicy-swift.enum/storeEncodedImages":{"role":"symbol","title":"ImagePipeline.Configuration.DataCachePolicy.storeEncodedImages","fragments":[{"kind":"keyword","text":"case"},{"kind":"text","text":" "},{"kind":"identifier","text":"storeEncodedImages"}],"abstract":[{"type":"text","text":"For all requests, encode and store decoded images after all"},{"type":"text","text":" "},{"type":"text","text":"processors are applied."}],"identifier":"doc:\/\/com.github.kean.Nuke\/documentation\/Nuke\/ImagePipeline\/Configuration-swift.struct\/DataCachePolicy-swift.enum\/storeEncodedImages","kind":"symbol","type":"topic","url":"\/documentation\/nuke\/imagepipeline\/configuration-swift.struct\/datacachepolicy-swift.enum\/storeencodedimages"},"doc://com.github.kean.Nuke/documentation/Nuke":{"role":"collection","title":"Nuke","abstract":[{"type":"text","text":"Welcome to the documentation for Nuke, an image loading system for Apple platforms."}],"identifier":"doc:\/\/com.github.kean.Nuke\/documentation\/Nuke","kind":"symbol","type":"topic","url":"\/documentation\/nuke"}}}